class Qcachegrind < Formula
  desc "Visualize data generated by Cachegrind and Calltree"
  homepage "https://kcachegrind.github.io/"
  url "https://download.kde.org/stable/applications/16.12.0/src/kcachegrind-16.12.0.tar.xz"
  sha256 "9f73dd8a8cc624a11c54a364fc7583ed16654698df0ac21d25c54fbd4758c018"

  bottle do
    cellar :any
    sha256 "c34c78bb4f284e297fa7bbdf1b6474296781f56a2bc4b4e91f19a1584b17d920" => :sierra
    sha256 "1becad19852da7f2acdeaa06693867e57c38784f124f204ff8c655dda0c013d0" => :el_capitan
    sha256 "575bce5416f2b70f293815d90bde6ed0a424bfdd28c7f131b68941b8ae828940" => :yosemite
  end

  depends_on "graphviz" => :optional
  depends_on "qt5"

  def install
    cd "qcachegrind"
    system "#{Formula["qt5"].bin}/qmake", "-spec", "macx-clang", "-config", "release"
    system "make"
    # Install app
    prefix.install "qcachegrind.app"
    # Symlink in the command-line version
    bin.install_symlink prefix/"qcachegrind.app/Contents/MacOS/qcachegrind"
  end
end
